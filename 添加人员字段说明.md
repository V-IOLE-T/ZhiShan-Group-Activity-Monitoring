# 添加"人员"字段到多维表格

## 📋 操作步骤

### 1. 打开飞书多维表格
- 打开你的飞书多维表格（使用 `BITABLE_APP_TOKEN` 对应的表格）

### 2. 添加"人员"字段
1. 点击表格右侧的 **"+"** 按钮添加新列
2. 在字段名称中输入：`人员`
3. 在字段类型中选择：**人员**
4. 保存字段

### 3. 字段说明
- **字段名称**：`人员`（必须完全一致）
- **字段类型**：人员（Person）
- **作用**：自动关联到飞书账号，可以直接 @ 用户

### 4. 代码已自动配置
代码已经更新，会自动将用户的 `open_id` 关联到这个字段。格式如下：

```python
"人员": [{"id": user_id}]  # user_id 是用户的 open_id
```

### 5. 效果
添加后，表格中的"人员"列会显示：
- ✅ 用户的飞书头像
- ✅ 用户的真实姓名
- ✅ 可以直接点击跳转到用户主页
- ✅ 可以在表格中 @ 该用户

## 🔍 验证字段配置

运行以下命令检查所有字段是否配置正确：

```bash
python check_table_fields.py
```

这个脚本会列出表格中的所有字段，并检查是否包含所有必需字段。

## 📊 完整字段列表

你的多维表格应该包含以下字段：

| 字段名 | 字段类型 | 说明 |
|--------|----------|------|
| 用户ID | 文本 | 用户的 open_id |
| 用户名称 | 文本 | 用户的群昵称 |
| **人员** | **人员** | **关联飞书账号（新增）** |
| 统计周期 | 文本 | 格式：YYYY-MM |
| 更新时间 | 数字 | 时间戳（毫秒） |
| 发言次数 | 数字 | 发送消息数量 |
| 发言字数 | 数字 | 发送文字总数 |
| 被回复数 | 数字 | 被回复次数 |
| 单独被@次数 | 数字 | 被 @ 次数 |
| 发起话题数 | 数字 | 发起话题数量 |
| 活跃度分数 | 数字 | 综合活跃度分数 |

## ⚠️ 注意事项

1. **字段名称必须完全一致**：包括中文字符和标点符号
2. **字段类型必须正确**：特别是"人员"字段必须选择"人员"类型
3. **添加字段后无需重启程序**：程序会自动使用新字段

## 🚀 测试

添加字段后，在群里发一条消息，程序会自动：
1. 更新所有数值字段
2. 在"人员"字段中关联发送者的飞书账号

你会在表格中看到该用户的头像和姓名！
